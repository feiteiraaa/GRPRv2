App As appinfo:
    BackEnabled: =false
    OnStart: |-
        =Concurrent(
            Set(appVersion, "1.0"),
            With(
                {records: 
                    //substituir pelos dados das notificações
        CustomGallerySample},
                ForAll(
                    Sequence(CountRows(records)),
                    Patch(
                        Last(
                            FirstN(
                                records,
                                Value
                            )
                        ),
                        {rowNumber: Value}
                    )
                );
                Set(
                    Notificacoes,
                    records
                )
            ),
            Set(
                cores,
                {
                    amareloMontepio: RGBA(
                        255,
                        191,
                        0,
                        1
                    ),
                    cinzento: RGBA(
                        70,
                        70,
                        70,
                        1
                    ),
                    rosa: ColorFade(
                        Color.Red,
                        0.9
                    ),
                    azulTitulo: RGBA(50, 86, 160, 1)
                }
            ),
            Set(
                godMode,
                If(
                    Or(
                        "gvfeiteira" in User().Email,
                        "ldsales.ex@montepio.pt" in User().Email,
                        "lssales" in User().Email,
                        "cnpedroso" in User().Email,
                        "pvveras" in User().Email,
                        "grdias" in User().Email
                    ),
                    true,
                    false
                )
            ),
            Set(
                DRI,
                If(
                    CountRows(
                        Filter(
                            Office365Groups.ListOwnedGroupsV3().value,
                            displayName = "GRPR-DRI-Gestor"
                        )
                    ) < 1,
                    false,
                    true
                )
            ),
            Set(
                DGC_Editor,
                If(
                    CountRows(
                        Filter(
                            Office365Groups.ListOwnedGroupsV3().value,
                            displayName = "GRPR-DGC-Editor"
                        )
                    ) < 1,
                    false,
                    true
                )
            ),
            Set(
                DCRF_Editor,
                If(
                    CountRows(
                        Filter(
                            Office365Groups.ListOwnedGroupsV3().value,
                            displayName = "GRPR-DCRF-Editor"
                        )
                    ) < 1,
                    false,
                    true
                )
            ),
            Set(
                DGP_Editor,
                If(
                    CountRows(
                        Filter(
                            Office365Groups.ListOwnedGroupsV3().value,
                            displayName = "GRPR-DGP-Editor"
                        )
                    ) < 1,
                    false,
                    true
                )
            ),
            Set(
                GCONT_Editor,
                If(
                    CountRows(
                        Filter(
                            Office365Groups.ListOwnedGroupsV3().value,
                            displayName = "GRPR-GCONT-Editor"
                        )
                    ) < 1,
                    false,
                    true
                )
            ),
            Set(
                DGC_Validador,
                If(
                    CountRows(
                        Filter(
                            Office365Groups.ListOwnedGroupsV3().value,
                            displayName = "GRPR-DGC-Validador"
                        )
                    ) < 1,
                    false,
                    true
                )
            ),
            Set(
                DGP_Validador,
                If(
                    CountRows(
                        Filter(
                            Office365Groups.ListOwnedGroupsV3().value,
                            displayName = "GRPR-DGP-Validador"
                        )
                    ) < 1,
                    false,
                    true
                )
            ),
            Set(
                DCRF_Validador,
                If(
                    CountRows(
                        Filter(
                            Office365Groups.ListOwnedGroupsV3().value,
                            displayName = "GRPR-DCRF-Validador"
                        )
                    ) < 1,
                    false,
                    true
                )
            ),
            Set(
                GCONT_Validador,
                If(
                    CountRows(
                        Filter(
                            Office365Groups.ListOwnedGroupsV3().value,
                            displayName = "GRPR-GCONT-Validador"
                        )
                    ) < 1,
                    false,
                    true
                )
            ),
            Set(
                DCOMP_Consulta,
                If(
                    CountRows(
                        Filter(
                            Office365Groups.ListOwnedGroupsV3().value,
                            displayName = "GRPR-DCOMP-Consulta"
                        )
                    ) < 1,
                    false,
                    true
                )
            ),
            Set(
                DAI_Consulta,
                If(
                    CountRows(
                        Filter(
                            Office365Groups.ListOwnedGroupsV3().value,
                            displayName = "GRPR-DAI-Consulta"
                        )
                    ) < 1,
                    false,
                    true
                )
            ),
            Set(
                DMK_Consulta,
                If(
                    CountRows(
                        Filter(
                            Office365Groups.ListOwnedGroupsV3().value,
                            displayName = "GRPR-DMK-Consulta"
                        )
                    ) < 1,
                    false,
                    true
                )
            ),
            Set(
                CCOMP_Consulta,
                If(
                    CountRows(
                        Filter(
                            Office365Groups.ListOwnedGroupsV3().value,
                            displayName = "GRPR-CCOMP-Consulta"
                        )
                    ) < 1,
                    false,
                    true
                )
            )
        );
        Set(
            varSortCol,
            "uipp_nome"
        );
        Set(
            varSortDir,
            SortOrder.Descending
        );
        
        
        //temporary - UO tests
        //If(User().Email = "grdias.ex@montepio.pt",
        //Set(DGC_Validador, true); Set(godMode, false) ;//, Set(godMode, true)
        //);
        Set(DGC_Validador, true);
        Set(godMode,false);
        ClearCollect(
            menuTable,
            Table(
            {
                selected: true,
                icon: Icon.Home,
                text: "Inicio",
                Navigate: Inicio,
                VisivelPara: true
            },
            If(
                Or(godMode, DRI, DGC_Editor, DGC_Validador, DGP_Editor, DGP_Validador, GCONT_Editor, GCONT_Validador, DCOMP_Consulta, DAI_Consulta),
                {
                    selected: false,
                    icon: Icon.People,
                    text: "Particulares e empresas respetivas",
                    Navigate: Particulares,
                    VisivelPara: Or(godMode, DRI, DGC_Editor, DGC_Validador, DGP_Editor, DGP_Validador, GCONT_Editor, GCONT_Validador, DCOMP_Consulta, DAI_Consulta)
                }
            ),
            If(
                Or(godMode, DRI, DGC_Editor, DGC_Validador, GCONT_Editor, GCONT_Validador, DCOMP_Consulta, DAI_Consulta,CCOMP_Consulta, DMK_Consulta),
                {
                    selected: false,
                    icon: Icon.OfficeBuilding,
                    text: "Empresas respetivas",
                    Navigate: Respetivas,
                    VisivelPara: Or(godMode, DRI, DGC_Editor, DGC_Validador, GCONT_Editor, GCONT_Validador, DCOMP_Consulta, DAI_Consulta,CCOMP_Consulta, DMK_Consulta)
                }
            ),
            If(
                Or(godMode, DRI, DCRF_Editor, DCRF_Validador, DCOMP_Consulta, DAI_Consulta, CCOMP_Consulta, DMK_Consulta),
                {
                    selected: false,
                    icon: Icon.OfficeBuilding,
                    text: "Empresas participadas do grupo",
                    Navigate: Participadas,
                    VisivelPara: Or(godMode, DRI, DCRF_Editor, DCRF_Validador, DCOMP_Consulta, DAI_Consulta, CCOMP_Consulta, DMK_Consulta)
                }
            ),
            If(
                Or(godMode, DRI, DGC_Editor, DGC_Validador, DCRF_Editor, DCRF_Validador, DGP_Editor, DGP_Validador, GCONT_Editor, GCONT_Validador, DCOMP_Consulta, DAI_Consulta,CCOMP_Consulta, DMK_Consulta),
                {
                    selected: false,
                    icon: Icon.Information,
                    text: "Atividade",
                    Navigate: Atividade,
                    VisivelPara: Or(godMode, DRI, DGC_Editor, DGC_Validador, DCRF_Editor, DCRF_Validador, DGP_Editor, DGP_Validador, GCONT_Editor, GCONT_Validador, DCOMP_Consulta,  DAI_Consulta,CCOMP_Consulta, DMK_Consulta)
                }
            ),
            If(
                Or(godMode, DRI, DCOMP_Consulta, DAI_Consulta),
                {
                    selected: false,
                    icon: Icon.Notebook,
                    text: "Listagens",
                    Navigate: Listagens,
                    VisivelPara: Or(godMode, DRI, DCOMP_Consulta, DAI_Consulta)
                }
            ),
            If(
                Or(godMode, DRI),
                {
                    selected: false,
                    icon: Icon.Settings,
                    text: "Configurações",
                    Navigate: Configuracoes,
                    VisivelPara: Or(godMode, DRI)
                }
            )
        ));
        RemoveIf(menuTable, IsBlank(ThisRecord) )

    Host As hostControl.DefaultHostControlVariant:
        OnCancel: =false
        OnEdit: =false
        OnNew: =false
        OnSave: =false
        OnView: =false

